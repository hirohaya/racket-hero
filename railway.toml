# Railway Project Configuration
# Este arquivo configura como o Railway detecta e constrói seus serviços

[build]
# Define qual builders usar para cada serviço
builder = "nixpacks"

# Variáveis de ambiente disponíveis durante build
[build.env]
# Node.js
NODE_ENV = "production"
NODE_OPTIONS = "--max-old-space-size=512"

# Python
PYTHONUNBUFFERED = "1"

# Configurações por serviço
[[services]]
name = "backend"
startCommand = "python main.py"
nixpacks.buildPackages = ["python311", "postgresql"]
nixpacks.aptPackages = ["build-essential", "libpq-dev"]

# Detectar automaticamente portas
detectPort = true

# Healthcheck do serviço
[services.healthchecks]
enabled = true
endpoint = "/health"
initialDelaySeconds = 10
intervalSeconds = 30
timeoutSeconds = 5

[[services]]
name = "frontend"
startCommand = "npm start"
nixpacks.buildPackages = ["nodejs_20", "npm"]
root = "frontend"

# Detectar automaticamente portas
detectPort = true

# Healthcheck do serviço
[services.healthchecks]
enabled = true
endpoint = "/"
initialDelaySeconds = 15
intervalSeconds = 30
timeoutSeconds = 5
